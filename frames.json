[
  {
    "text": "Welcome! In this tutorial, weâ€™re building a modular Express Middleware system. We'll start with the package.json to define our dependencies and the start script for our server.",
    "tree": [
      {
        "path": "server-demo",
        "type": "folder"
      },
      {
        "path": "server-demo/package.json",
        "type": "file"
      }
    ],
    "selectedFile": "server-demo/package.json",
    "content": "{\n  \"name\": \"express-middleware-demo\",\n  \"version\": \"1.0.0\",\n  \"description\": \"A demo of custom middleware in Express\",\n  \"main\": \"index.js\",\n  \"dependencies\": {\n    \"express\": \"^4.18.2\"\n  },\n  \"scripts\": {\n    \"start\": \"node index.js\"\n  }\n}\n",
    "language": "json",
    "scrollLine": 0,
    "highlights": [
      7,
      8,
      9,
      10,
      11
    ]
  },
  {
    "text": "First, we create a logger middleware. This function intercepts every request to log the HTTP method and the URL along with a timestamp to the console.",
    "tree": [
      {
        "path": "server-demo",
        "type": "folder"
      },
      {
        "path": "server-demo/middleware",
        "type": "folder"
      },
      {
        "path": "server-demo/middleware/logger.js",
        "type": "file"
      },
      {
        "path": "server-demo/package.json",
        "type": "file"
      }
    ],
    "selectedFile": "server-demo/middleware/logger.js",
    "content": "const requestLogger = (req, res, next) => {\n  const timestamp = new Date().toISOString();\n  console.log(`[${timestamp}] ${req.method} request to ${req.url}`);\n  next();\n};\n\nmodule.exports = requestLogger;\n",
    "language": "javascript",
    "scrollLine": 0,
    "highlights": [
      1,
      2,
      3,
      4,
      5
    ]
  },
  {
    "text": "Next, we implement an authentication middleware. It checks for an authorization header; if it's missing, it blocks the request and returns a 401 Unauthorized status.",
    "tree": [
      {
        "path": "server-demo",
        "type": "folder"
      },
      {
        "path": "server-demo/middleware",
        "type": "folder"
      },
      {
        "path": "server-demo/middleware/auth.js",
        "type": "file"
      },
      {
        "path": "server-demo/middleware/logger.js",
        "type": "file"
      },
      {
        "path": "server-demo/package.json",
        "type": "file"
      }
    ],
    "selectedFile": "server-demo/middleware/auth.js",
    "content": "const fakeAuth = (req, res, next) => {\n  const authHeader = req.headers['authorization'];\n  \n  if (!authHeader) {\n    return res.status(401).json({ \n      error: \"Unauthorized: No token provided\" \n    });\n  }\n  \n  next();\n};\n\nmodule.exports = fakeAuth;\n",
    "language": "javascript",
    "scrollLine": 0,
    "highlights": [
      1,
      2,
      3,
      5,
      6,
      7,
      10
    ]
  },
  {
    "text": "Now we assemble everything in index.js. We'll apply the logger globally and use the auth middleware specifically to protect our dashboard route.",
    "tree": [
      {
        "path": "server-demo",
        "type": "folder"
      },
      {
        "path": "server-demo/middleware",
        "type": "folder"
      },
      {
        "path": "server-demo/middleware/auth.js",
        "type": "file"
      },
      {
        "path": "server-demo/middleware/logger.js",
        "type": "file"
      },
      {
        "path": "server-demo/index.js",
        "type": "file"
      },
      {
        "path": "server-demo/package.json",
        "type": "file"
      }
    ],
    "selectedFile": "server-demo/index.js",
    "content": "const express = require('express');\nconst logger = require('./middleware/logger');\nconst auth = require('./middleware/auth');\n\nconst app = express();\nconst PORT = 3000;\n\n// Global Middleware\napp.use(logger);\n\n// Public Route\napp.get('/', (req, res) => {\n  res.send('Welcome to the Public API!');\n});\n\n// Protected Route\napp.get('/api/dashboard', auth, (req, res) => {\n  res.json({ data: \"Sensitive information.\" });\n});\n\napp.listen(PORT, () => {\n  console.log(`Server is running on http://localhost:${PORT}`);\n});\n",
    "language": "javascript",
    "scrollLine": 0,
    "highlights": [
      2,
      3,
      9,
      17
    ]
  },
  {
    "text": "That's it! You've built a modular server. Using middleware keeps your code clean and organized. Thanks for watching, and happy coding!",
    "tree": [
      {
        "path": "server-demo",
        "type": "folder"
      },
      {
        "path": "server-demo/middleware",
        "type": "folder"
      },
      {
        "path": "server-demo/middleware/auth.js",
        "type": "file"
      },
      {
        "path": "server-demo/middleware/logger.js",
        "type": "file"
      },
      {
        "path": "server-demo/index.js",
        "type": "file"
      },
      {
        "path": "server-demo/package.json",
        "type": "file"
      }
    ],
    "selectedFile": "server-demo/index.js",
    "content": "const express = require('express');\nconst logger = require('./middleware/logger');\nconst auth = require('./middleware/auth');\n\nconst app = express();\nconst PORT = 3000;\n\n// Global Middleware\napp.use(logger);\n\n// Public Route\napp.get('/', (req, res) => {\n  res.send('Welcome to the Public API!');\n});\n\n// Protected Route\napp.get('/api/dashboard', auth, (req, res) => {\n  res.json({ data: \"Sensitive information.\" });\n});\n\napp.listen(PORT, () => {\n  console.log(`Server is running on http://localhost:${PORT}`);\n});\n",
    "language": "javascript",
    "scrollLine": 15,
    "highlights": [
      21,
      22,
      23
    ]
  }
]
